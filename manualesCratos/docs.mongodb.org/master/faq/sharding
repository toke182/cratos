<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>FAQ: Sharding with MongoDB &mdash; MongoDB Manual</title>

    <link rel="shortcut icon" href="http://media.mongodb.org/favicon.ico" />
    <meta name="robots" content="index" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="canonical" href="http://docs.mongodb.org/master/faq/sharding" />

    
    
    <link rel="stylesheet" href="../../_static/mongodb-docs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.2.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
      <link rel="search" type="application/opensearchdescription+xml" href="http://docs.mongodb.org/osd.xml" title="MongoDB Help"/>
<link rel="author" title="About these documents" href="../../about/" />
<link rel="top" title="MongoDB Manual" href="../../" />
<link rel="up" title="Frequently Asked Questions" href="../" />
<link rel="next" title="FAQ: Replica Sets and Replication in MongoDB" href="../replica-sets/" />
<link rel="prev" title="FAQ: Concurrency" href="../concurrency/" />
<!-- Put the following javascript before the closing </head> tag. -->
<script>
  (function() {
    var cx = '017213726194841070573:WMX6838984';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script>
  </head>
  <body>
<div id="top-right">
        <div class="user-right">
                <ul id="header-menu-bar" class="ajs-menu-bar">
                <li class="normal"><a target="_blank" href="http://groups.google.com/group/mongodb-user">Forums</a></li>
                <li class="normal"><a target="_blank" href="http://blog.mongodb.org/">Blog</a></li>
                <li class="normal"><a href="http://www.mongodb.org/downloads">Download</a></li>
                <li class="normal"><a href="http://www.mongodb.org/display/DOCS/Drivers">Drivers</a></li>
                <li class="normal"><a href="http://www.mongodb.org/display/DOCS/Events">Events</a></li>
                <li class="normal last"><a class="last" href="http://www.mongodb.org/display/DOCS/International+Documentation">International</a></li>
                </ul>
        </div>
</div>
<div id="header-db" class="spread">
        <div class="split">
                <div id="logo">
                        <div><a href="../../"><img src="../../_static/logo-mongodb.png" width="190" height="55" alt="mongoDB" /></a></div>
                </div>
        </div>
<div class="search-db"><gcse:searchbox></gcse:searchbox></div>
<div id="etp">
<ul>
<li><a href="https://github.com/mongodb/docs/blob/master/source/faq/sharding.txt" target="_blank" title="Edit faq/sharding.txt on github">Edit this Page</a></li>
<li><a href="http://github.com/mongodb/docs" target="_blank" title="Fork the documentation on GitHub and contribute.">GitHub</a></li>
<li><a href="https://jira.mongodb.org/secure/CreateIssueDetails!init.jspa?pid=10380&issuetype=4&priority=4&summary=Comment+on%3a+%22faq/sharding%2Etxt%22" target="_blank" title="Report a problem with faq/sharding.txt on Jira">Report a problem</a></li>
</ul>
</div>
</div>  
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            <div id="cse-results"><gcse:searchresults></gcse:searchresults></div>
            
  <div class="section" id="faq-sharding-with-mongodb">
<h1>FAQ: Sharding with MongoDB<a class="headerlink" href="#faq-sharding-with-mongodb" title="Permalink to this headline">¶</a></h1>
<p>This document answers common questions about horizontal scaling
using MongoDB&#8217;s <a class="reference internal" href="../../reference/glossary/#term-sharding"><em class="xref std std-term">sharding</em></a>.</p>
<p>If you don&#8217;t find the answer you&#8217;re looking for, check
the <a class="reference internal" href="../"><em>complete list of FAQs</em></a> or post your question to the
<a class="reference external" href="https://groups.google.com/forum/?fromgroups#!forum/mongodb-user">MongoDB User Mailing List</a>.</p>
<div class="contents local topic" id="frequently-asked-questions">
<p class="topic-title first">Frequently Asked Questions:</p>
<ul class="simple">
<li><a class="reference internal" href="#is-sharding-appropriate-for-a-new-deployment" id="id1">Is sharding appropriate for a new deployment?</a></li>
<li><a class="reference internal" href="#how-does-sharding-work-with-replication" id="id2">How does sharding work with replication?</a></li>
<li><a class="reference internal" href="#can-i-change-the-shard-key-after-sharding-a-collection" id="id3">Can I change the shard key after sharding a collection?</a></li>
<li><a class="reference internal" href="#what-happens-to-unsharded-collections-in-sharded-databases" id="id4">What happens to unsharded collections in sharded databases?</a></li>
<li><a class="reference internal" href="#how-does-mongodb-distribute-data-across-shards" id="id5">How does MongoDB distribute data across shards?</a></li>
<li><a class="reference internal" href="#what-happens-if-a-client-updates-a-document-in-a-chunk-during-a-migration" id="id6">What happens if a client updates a document in a chunk during a migration?</a></li>
<li><a class="reference internal" href="#what-happens-to-queries-if-a-shard-is-inaccessible-or-slow" id="id7">What happens to queries if a shard is inaccessible or slow?</a></li>
<li><a class="reference internal" href="#how-does-mongodb-distribute-queries-among-shards" id="id8">How does MongoDB distribute queries among shards?</a></li>
<li><a class="reference internal" href="#how-does-mongodb-sort-queries-in-sharded-environments" id="id9">How does MongoDB sort queries in sharded environments?</a></li>
<li><a class="reference internal" href="#how-does-mongodb-ensure-unique-id-field-values-when-using-a-shard-key-other-than-id" id="id10">How does MongoDB ensure unique <tt class="docutils literal"><span class="pre">_id</span></tt> field values when using a shard key <em>other</em> than <tt class="docutils literal"><span class="pre">_id</span></tt>?</a></li>
<li><a class="reference internal" href="#i-ve-enabled-sharding-and-added-a-second-shard-but-all-the-data-is-still-on-one-server-why" id="id11">I&#8217;ve enabled sharding and added a second shard, but all the data is still on one server. Why?</a></li>
<li><a class="reference internal" href="#is-it-safe-to-remove-old-files-in-the-movechunk-directory" id="id12">Is it safe to remove old files in the <tt class="docutils literal"><span class="pre">moveChunk</span></tt> directory?</a></li>
<li><a class="reference internal" href="#how-many-connections-does-each-mongos-need" id="id13">How many connections does each <tt class="docutils literal"><span class="pre">mongos</span></tt> need?</a></li>
<li><a class="reference internal" href="#why-does-mongos-hold-connections" id="id14">Why does <tt class="docutils literal"><span class="pre">mongos</span></tt> hold connections?</a></li>
<li><a class="reference internal" href="#where-does-mongodb-report-on-connections-used-by-mongos" id="id15">Where does MongoDB report on connections used by <tt class="docutils literal"><span class="pre">mongos</span></tt>?</a></li>
<li><a class="reference internal" href="#what-does-writebacklisten-in-the-log-mean" id="id16">What does <tt class="docutils literal"><span class="pre">writebacklisten</span></tt> in the log mean?</a></li>
<li><a class="reference internal" href="#how-should-administrators-deal-with-failed-migrations" id="id17">How should administrators deal with failed migrations?</a></li>
<li><a class="reference internal" href="#what-is-the-process-for-moving-renaming-or-changing-the-number-of-config-servers" id="id18">What is the process for moving, renaming, or changing the number of config servers?</a></li>
<li><a class="reference internal" href="#when-do-the-mongos-servers-detect-config-server-changes" id="id19">When do the <tt class="docutils literal"><span class="pre">mongos</span></tt> servers detect config server changes?</a></li>
<li><a class="reference internal" href="#is-it-possible-to-quickly-update-mongos-servers-after-updating-a-replica-set-configuration" id="id20">Is it possible to quickly update <tt class="docutils literal"><span class="pre">mongos</span></tt> servers after updating a replica set configuration?</a></li>
<li><a class="reference internal" href="#what-does-the-maxconns-setting-on-mongos-do" id="id21">What does the <tt class="docutils literal"><span class="pre">maxConns</span></tt> setting on <tt class="docutils literal"><span class="pre">mongos</span></tt> do?</a></li>
<li><a class="reference internal" href="#how-do-indexes-impact-queries-in-sharded-systems" id="id22">How do indexes impact queries in sharded systems?</a></li>
<li><a class="reference internal" href="#can-shard-keys-be-randomly-generated" id="id23">Can shard keys be randomly generated?</a></li>
<li><a class="reference internal" href="#can-shard-keys-have-a-non-uniform-distribution-of-values" id="id24">Can shard keys have a non-uniform distribution of values?</a></li>
<li><a class="reference internal" href="#can-you-shard-on-the-id-field" id="id25">Can you shard on the <tt class="docutils literal"><span class="pre">_id</span></tt> field?</a></li>
<li><a class="reference internal" href="#can-shard-key-be-in-ascending-order-like-dates-or-timestamps" id="id26">Can shard key be in ascending order, like dates or timestamps?</a></li>
<li><a class="reference internal" href="#what-do-movechunk-commit-failed-errors-mean" id="id27">What do <tt class="docutils literal"><span class="pre">moveChunk</span> <span class="pre">commit</span> <span class="pre">failed</span></tt> errors mean?</a></li>
</ul>
</div>
<div class="section" id="is-sharding-appropriate-for-a-new-deployment">
<h2>Is sharding appropriate for a new deployment?<a class="headerlink" href="#is-sharding-appropriate-for-a-new-deployment" title="Permalink to this headline">¶</a></h2>
<p>Sometimes.</p>
<p>If your data set fits on a single servers, you should begin
with an unsharded deployment.</p>
<p>Converting an unsharded database to a <a class="reference internal" href="../../reference/glossary/#term-sharded-cluster"><em class="xref std std-term">sharded cluster</em></a> is easy
and seamless, so there is <em>little advantage</em> in configuring sharding
while your data set is small.</p>
<p>Still, all production deployments should use <a class="reference internal" href="../../reference/glossary/#term-replication"><em class="xref std std-term">replica sets</em></a> to provide high availability and disaster recovery.</p>
</div>
<div class="section" id="how-does-sharding-work-with-replication">
<h2>How does sharding work with replication?<a class="headerlink" href="#how-does-sharding-work-with-replication" title="Permalink to this headline">¶</a></h2>
<p>To use replication with sharding, deploy each <a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a> as a
<a class="reference internal" href="../../reference/glossary/#term-replica-set"><em class="xref std std-term">replica set</em></a>.</p>
</div>
<div class="section" id="can-i-change-the-shard-key-after-sharding-a-collection">
<span id="faq-change-shard-key"></span><h2>Can I change the shard key after sharding a collection?<a class="headerlink" href="#can-i-change-the-shard-key-after-sharding-a-collection" title="Permalink to this headline">¶</a></h2>
<p>No.</p>
<p>There is no automatic support in MongoDB for changing a shard key
after <a class="reference internal" href="../../administration/sharding/#sharding-administration-shard-collection"><em>sharding a collection</em></a>. This reality underscores
the important of choosing a good <a class="reference internal" href="../../core/sharding/#shard-key"><em>shard key</em></a>. If you
<em>must</em> change a shard key after sharding a collection, the best option
is to:</p>
<ul class="simple">
<li>dump all data from MongoDB into an external format.</li>
<li>drop the original sharded collection.</li>
<li>configure sharding using a more ideal shard key.</li>
<li><a class="reference internal" href="../../administration/sharding/#sharding-administration-pre-splitting"><em>pre-split</em></a> the shard
key range to ensure initial even distribution.</li>
<li>restore the dumped data into MongoDB.</li>
</ul>
<p>See <a class="reference internal" href="../../reference/commands/#shardCollection" title="shardCollection"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">shardCollection</span></tt></a>, <a class="reference internal" href="../../reference/method/sh.shardCollection/#sh.shardCollection" title="sh.shardCollection"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">sh.shardCollection()</span></tt></a>,
<a class="reference internal" href="../../administration/sharding/"><em>Sharded Cluster Administration</em></a>, the <a class="reference internal" href="../../core/sharding-internals/#sharding-internals-shard-keys"><em>Shard Key</em></a> section in the
<a class="reference internal" href="../../core/sharding-internals/"><em>Sharding Internals</em></a> document,
<a class="reference internal" href="../../tutorial/deploy-shard-cluster/"><em>Deploy a Sharded Cluster</em></a>, and <a class="reference external" href="https://jira.mongodb.org/browse/SERVER-4000">SERVER-4000</a> for
more information.</p>
</div>
<div class="section" id="what-happens-to-unsharded-collections-in-sharded-databases">
<h2>What happens to unsharded collections in sharded databases?<a class="headerlink" href="#what-happens-to-unsharded-collections-in-sharded-databases" title="Permalink to this headline">¶</a></h2>
<p>In the current implementation, all databases in a <a class="reference internal" href="../../reference/glossary/#term-sharded-cluster"><em class="xref std std-term">sharded
cluster</em></a> have a &#8220;primary <a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a>.&#8221; All unsharded
collection within that database will reside on the same shard.</p>
</div>
<div class="section" id="how-does-mongodb-distribute-data-across-shards">
<h2>How does MongoDB distribute data across shards?<a class="headerlink" href="#how-does-mongodb-distribute-data-across-shards" title="Permalink to this headline">¶</a></h2>
<p>Sharding must be specifically enabled on a collection. After enabling
sharding on the collection, MongoDB will assign various ranges of
collection data to the different shards in the cluster. The cluster
automatically corrects imbalances between shards by migrating ranges
of data from one shard to another.</p>
</div>
<div class="section" id="what-happens-if-a-client-updates-a-document-in-a-chunk-during-a-migration">
<h2>What happens if a client updates a document in a chunk during a migration?<a class="headerlink" href="#what-happens-if-a-client-updates-a-document-in-a-chunk-during-a-migration" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> routes the operation to the &#8220;old&#8221; shard, where
it will succeed immediately. Then the <a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a> <tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt>
instances will replicate the modification to the &#8220;new&#8221; shard before
the <a class="reference internal" href="../../reference/glossary/#term-sharded-cluster"><em class="xref std std-term">sharded cluster</em></a> updates that chunk&#8217;s &#8220;ownership,&#8221; which
effectively finalizes the migration process.</p>
</div>
<div class="section" id="what-happens-to-queries-if-a-shard-is-inaccessible-or-slow">
<h2>What happens to queries if a shard is inaccessible or slow?<a class="headerlink" href="#what-happens-to-queries-if-a-shard-is-inaccessible-or-slow" title="Permalink to this headline">¶</a></h2>
<p>If a <a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a> is inaccessible or unavailable, queries will return
with an error.</p>
<p>However, a client may set the <tt class="docutils literal"><span class="pre">partial</span></tt> query bit, which will then
return results from all available shards, regardless of whether a
given shard is unavailable.</p>
<p>If a shard is responding slowly, <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> will merely wait
for the shard to return results.</p>
</div>
<div class="section" id="how-does-mongodb-distribute-queries-among-shards">
<h2>How does MongoDB distribute queries among shards?<a class="headerlink" href="#how-does-mongodb-distribute-queries-among-shards" title="Permalink to this headline">¶</a></h2>
<p class="versionchanged">
<span class="versionmodified">Changed in version 2.0.</span></p>
<p>The exact method for distributing queries to <a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shards</em></a> in a
<a class="reference internal" href="../../reference/glossary/#term-sharded-cluster"><em class="xref std std-term">cluster</em></a> depends on the nature of the query and the configuration of
the sharded cluster. Consider a sharded collection, using the
<a class="reference internal" href="../../reference/glossary/#term-shard-key"><em class="xref std std-term">shard key</em></a> <tt class="docutils literal"><span class="pre">user_id</span></tt>, that has <tt class="docutils literal"><span class="pre">last_login</span></tt> and
<tt class="docutils literal"><span class="pre">email</span></tt> attributes:</p>
<ul>
<li><p class="first">For a query that selects one or more values for the <tt class="docutils literal"><span class="pre">user_id</span></tt>
key:</p>
<p><a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> determines which shard or shards contains the
relevant data, based on the cluster metadata, and directs a query to
the required shard or shards, and returns those results to the
client.</p>
</li>
<li><p class="first">For a query that selects <tt class="docutils literal"><span class="pre">user_id</span></tt> and also performs a sort:</p>
<p><a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> can make a straightforward translation of this
operation into a number of queries against the relevant shards,
ordered by <tt class="docutils literal"><span class="pre">user_id</span></tt>. When the sorted queries return from all
shards, the <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> merges the sorted results and returns
the complete result to the client.</p>
</li>
<li><p class="first">For queries that select on <tt class="docutils literal"><span class="pre">last_login</span></tt>:</p>
<p>These queries must run on all shards: <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> must
parallelize the query over the shards and perform a merge-sort on
the <tt class="docutils literal"><span class="pre">email</span></tt> of the documents found.</p>
</li>
</ul>
</div>
<div class="section" id="how-does-mongodb-sort-queries-in-sharded-environments">
<h2>How does MongoDB sort queries in sharded environments?<a class="headerlink" href="#how-does-mongodb-sort-queries-in-sharded-environments" title="Permalink to this headline">¶</a></h2>
<p>If you call the <a class="reference internal" href="../../reference/method/cursor.sort/#cursor.sort" title="cursor.sort"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">cursor.sort()</span></tt></a> method on a query in a sharded
environment, the <tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt> for each shard will sort its
results, and the <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> merges each shard&#8217;s results before returning
them to the client.</p>
</div>
<div class="section" id="how-does-mongodb-ensure-unique-id-field-values-when-using-a-shard-key-other-than-id">
<h2>How does MongoDB ensure unique <tt class="docutils literal"><span class="pre">_id</span></tt> field values when using a shard key <em>other</em> than <tt class="docutils literal"><span class="pre">_id</span></tt>?<a class="headerlink" href="#how-does-mongodb-ensure-unique-id-field-values-when-using-a-shard-key-other-than-id" title="Permalink to this headline">¶</a></h2>
<p>If you do not use <tt class="docutils literal"><span class="pre">_id</span></tt> as the shard key, then your
application/client layer must be responsible for keeping the <tt class="docutils literal"><span class="pre">_id</span></tt>
field unique. It is problematic for collections to have duplicate
<tt class="docutils literal"><span class="pre">_id</span></tt> values.</p>
<p>If you&#8217;re not sharding your collection by the <tt class="docutils literal"><span class="pre">_id</span></tt> field, then you
should be sure to store a globally unique identifier in that
field. The default <a class="reference external" href="http://www.mongodb.org/display/DOCS/Object+IDs">BSON ObjectID</a> works well in
this case.</p>
</div>
<div class="section" id="i-ve-enabled-sharding-and-added-a-second-shard-but-all-the-data-is-still-on-one-server-why">
<h2>I&#8217;ve enabled sharding and added a second shard, but all the data is still on one server. Why?<a class="headerlink" href="#i-ve-enabled-sharding-and-added-a-second-shard-but-all-the-data-is-still-on-one-server-why" title="Permalink to this headline">¶</a></h2>
<p>First, ensure that you&#8217;ve declared a <a class="reference internal" href="../../reference/glossary/#term-shard-key"><em class="xref std std-term">shard key</em></a> for your
collection. Until you have configured the shard key, MongoDB will not
create <a class="reference internal" href="../../reference/glossary/#term-chunk"><em class="xref std std-term">chunks</em></a>, and <a class="reference internal" href="../../reference/glossary/#term-sharding"><em class="xref std std-term">sharding</em></a> will not occur.</p>
<p>Next, keep in mind that the default chunk size is 64 MB. As a result,
in most situations, the collection needs at least 64 MB before a
migration will occur.</p>
<p>Additionally, the system which balances chunks among the servers
attempts to avoid superfluous migrations. Depending on the number of
shards, your shard key, and the amount of data, systems often require
at least 10 chunks of data to trigger migrations.</p>
<p>You can run <a class="reference internal" href="../../reference/method/db.printShardingStatus/#db.printShardingStatus" title="db.printShardingStatus"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.printShardingStatus()</span></tt></a> to see all the chunks
present in your cluster.</p>
</div>
<div class="section" id="is-it-safe-to-remove-old-files-in-the-movechunk-directory">
<h2>Is it safe to remove old files in the <tt class="docutils literal"><span class="pre">moveChunk</span></tt> directory?<a class="headerlink" href="#is-it-safe-to-remove-old-files-in-the-movechunk-directory" title="Permalink to this headline">¶</a></h2>
<p>Yes. <tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt> creates these files as backups during normal
<a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a> balancing operations.</p>
<p>Once these migrations are complete, you may delete these files.</p>
<p>You can set <a class="reference internal" href="../../reference/configuration-options/#noMoveParanoia" title="noMoveParanoia"><tt class="xref mongodb mongodb-setting docutils literal"><span class="pre">noMoveParanoia</span></tt></a> to <tt class="docutils literal"><span class="pre">true</span></tt> to disable this
behavior.</p>
</div>
<div class="section" id="how-many-connections-does-each-mongos-need">
<h2>How many connections does each <tt class="docutils literal"><span class="pre">mongos</span></tt> need?<a class="headerlink" href="#how-many-connections-does-each-mongos-need" title="Permalink to this headline">¶</a></h2>
<p>Typically, each client maintains as connection to
<a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a>. <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> maintains a connection pool to
support a single outgoing connection to each shard for. For incoming
connections that direct read operations to secondaries, the
<a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> will also need to maintain connects to each member
of the replica set that provides the shard.</p>
</div>
<div class="section" id="why-does-mongos-hold-connections">
<h2>Why does <tt class="docutils literal"><span class="pre">mongos</span></tt> hold connections?<a class="headerlink" href="#why-does-mongos-hold-connections" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> uses a set of connection pools to communicate with
each <a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a>.  These pools do not shrink when the number of
clients decreases.</p>
<p>This can lead to an unused <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> with a large number open
of connections. If the <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> is no longer in use, you&#8217;re
safe restarting the process to close existing connections.</p>
</div>
<div class="section" id="where-does-mongodb-report-on-connections-used-by-mongos">
<h2>Where does MongoDB report on connections used by <tt class="docutils literal"><span class="pre">mongos</span></tt>?<a class="headerlink" href="#where-does-mongodb-report-on-connections-used-by-mongos" title="Permalink to this headline">¶</a></h2>
<p>Connect to the <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> with the <tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt> shell, and
run the following command:</p>
<div class="highlight-sh"><div class="highlight"><pre>db._adminCommand<span class="o">(</span><span class="s2">&quot;connPoolStats&quot;</span><span class="o">)</span>;
</pre></div>
</div>
</div>
<div class="section" id="what-does-writebacklisten-in-the-log-mean">
<h2>What does <tt class="docutils literal"><span class="pre">writebacklisten</span></tt> in the log mean?<a class="headerlink" href="#what-does-writebacklisten-in-the-log-mean" title="Permalink to this headline">¶</a></h2>
<p>The writeback listener is a process that opens a long poll to relay
writes back from a <tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt> or <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> after
migrations to make sure they have not gone to the wrong server.  The
writeback listener sends writes back to the correct server if
necessary.</p>
<p>These messages are a key part of the sharding infrastructure and should
not cause concern.</p>
</div>
<div class="section" id="how-should-administrators-deal-with-failed-migrations">
<h2>How should administrators deal with failed migrations?<a class="headerlink" href="#how-should-administrators-deal-with-failed-migrations" title="Permalink to this headline">¶</a></h2>
<p>Failed migrations require no administrative intervention. Chunk moves are
consistent and deterministic.</p>
<p>If a migration fails to complete for some reason, the <a class="reference internal" href="../../reference/glossary/#term-cluster"><em class="xref std std-term">cluster</em></a>
will retry the operation. When the migration completes successfully,
the data will reside only on the new shard.</p>
</div>
<div class="section" id="what-is-the-process-for-moving-renaming-or-changing-the-number-of-config-servers">
<h2>What is the process for moving, renaming, or changing the number of config servers?<a class="headerlink" href="#what-is-the-process-for-moving-renaming-or-changing-the-number-of-config-servers" title="Permalink to this headline">¶</a></h2>
<div class="admonition-see admonition seealso">
<p class="first admonition-title">See</p>
<p class="last">The wiki page that describes this process: &#8220;<a class="reference external" href="http://www.mongodb.org/display/DOCS/Changing+Config+Servers">Changing Configuration Servers</a>.&#8221;</p>
</div>
</div>
<div class="section" id="when-do-the-mongos-servers-detect-config-server-changes">
<h2>When do the <tt class="docutils literal"><span class="pre">mongos</span></tt> servers detect config server changes?<a class="headerlink" href="#when-do-the-mongos-servers-detect-config-server-changes" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> instances maintain a cache of the <a class="reference internal" href="../../reference/glossary/#term-config-database"><em class="xref std std-term">config
database</em></a> that holds the metadata for the <a class="reference internal" href="../../reference/glossary/#term-sharded-cluster"><em class="xref std std-term">sharded cluster</em></a>. This
metadata includes the mapping of <a class="reference internal" href="../../reference/glossary/#term-chunk"><em class="xref std std-term">chunks</em></a> to
<a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shards</em></a>.</p>
<p><a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> updates its cache lazily by issuing a request to a
shard and discovering that its metadata is out of date.  There is no
way to control this behavior from the client, but you can run the
<a class="reference internal" href="../../reference/commands/#flushRouterConfig" title="flushRouterConfig"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">flushRouterConfig</span></tt></a> command against any <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a>
to force it to refresh its cache.</p>
</div>
<div class="section" id="is-it-possible-to-quickly-update-mongos-servers-after-updating-a-replica-set-configuration">
<h2>Is it possible to quickly update <tt class="docutils literal"><span class="pre">mongos</span></tt> servers after updating a replica set configuration?<a class="headerlink" href="#is-it-possible-to-quickly-update-mongos-servers-after-updating-a-replica-set-configuration" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> instances will detect these changes without
intervention over time. However, if you want to force the
<a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> to reload its configuration, run the
<a class="reference internal" href="../../reference/commands/#flushRouterConfig" title="flushRouterConfig"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">flushRouterConfig</span></tt></a> command against to each
<a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> directly.</p>
</div>
<div class="section" id="what-does-the-maxconns-setting-on-mongos-do">
<h2>What does the <tt class="docutils literal"><span class="pre">maxConns</span></tt> setting on <tt class="docutils literal"><span class="pre">mongos</span></tt> do?<a class="headerlink" href="#what-does-the-maxconns-setting-on-mongos-do" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../../reference/configuration-options/#maxConns" title="maxConns"><tt class="xref mongodb mongodb-setting docutils literal"><span class="pre">maxConns</span></tt></a> option limits the number of connections
accepted by <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a>.</p>
<p>If your client driver or application creates a large number of
connections but allows them to time out rather than closing them
explicitly, then it might make sense to limit the number of
connections at the <a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> layer.</p>
<p>Set <a class="reference internal" href="../../reference/configuration-options/#maxConns" title="maxConns"><tt class="xref mongodb mongodb-setting docutils literal"><span class="pre">maxConns</span></tt></a> to a value slightly higher than the
maximum number of connections that the client creates, or the maximum
size of the connection pool. This setting prevents the
<a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> from causing connection spikes on the individual
<a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shards</em></a>. Spikes like these may disrupt the operation
and memory allocation of the <a class="reference internal" href="../../reference/glossary/#term-sharded-cluster"><em class="xref std std-term">sharded cluster</em></a>.</p>
</div>
<div class="section" id="how-do-indexes-impact-queries-in-sharded-systems">
<h2>How do indexes impact queries in sharded systems?<a class="headerlink" href="#how-do-indexes-impact-queries-in-sharded-systems" title="Permalink to this headline">¶</a></h2>
<p>If the query does not include the <a class="reference internal" href="../../reference/glossary/#term-shard-key"><em class="xref std std-term">shard key</em></a>, the
<a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> must send the query to all shards as a
&#8220;scatter/gather&#8221; operation. Each shard will, in turn, use <em>either</em> the
shard key index or another more efficient index to fulfill the query.</p>
<p>If the query includes multiple sub-expressions that reference the
fields indexed by the shard key <em>and</em> the secondary index, the
<a class="reference internal" href="../../reference/config-database/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> can route the queries to a specific shard and the
shard will use the index that will allow it to fulfill most
efficiently. See <a class="reference external" href="http://www.mongodb.org/download/attachments/2097354/how+queries+work+with+sharding.pdf">this document</a>
for more information.</p>
</div>
<div class="section" id="can-shard-keys-be-randomly-generated">
<h2>Can shard keys be randomly generated?<a class="headerlink" href="#can-shard-keys-be-randomly-generated" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../../reference/glossary/#term-shard-key"><em class="xref std std-term">Shard keys</em></a> can be random. Random keys ensure
optimal distribution of data across the cluster.</p>
<p><a class="reference internal" href="../../reference/glossary/#term-sharded-cluster"><em class="xref std std-term">Sharded clusters</em></a>, attempt to route queries to
<em>specific</em> shards when queries include the shard key as a parameter,
because these directed queries are more efficient. In many cases,
random keys can make it difficult to direct queries to specific
shards.</p>
</div>
<div class="section" id="can-shard-keys-have-a-non-uniform-distribution-of-values">
<h2>Can shard keys have a non-uniform distribution of values?<a class="headerlink" href="#can-shard-keys-have-a-non-uniform-distribution-of-values" title="Permalink to this headline">¶</a></h2>
<p>Yes. There is no requirement that documents be evenly distributed by
the shard key.</p>
<p>However, documents that have the shard key <em>must</em> reside in the same
<em>chunk</em> and therefore on the same server. If your sharded data set has
too many documents with the exact same shard key you will not be able
to distribute <em>those</em> documents across your sharded cluster.</p>
</div>
<div class="section" id="can-you-shard-on-the-id-field">
<h2>Can you shard on the <tt class="docutils literal"><span class="pre">_id</span></tt> field?<a class="headerlink" href="#can-you-shard-on-the-id-field" title="Permalink to this headline">¶</a></h2>
<p>You can use any field for the shard key. The <tt class="docutils literal"><span class="pre">_id</span></tt> field is a common
shard key.</p>
<p>Be aware that <tt class="docutils literal"><span class="pre">ObjectId()</span></tt> values, which are the default value of
the <tt class="docutils literal"><span class="pre">_id</span></tt> field, increment as a timestamp. As a result, when used as
a shard key, all new documents inserted into the collection will
initially belong to the same chunk on a single shard. Although the
system will eventually divide this chunk and migrate its contents to
distribute data more evenly, at any moment the cluster can only direct
insert operations at a single shard. This can limit the throughput of
inserts. If most of your write operations are updates or read
operations rather than inserts, this limitation should not impact
your performance. However, if you have a high insert volume, this may
be a limitation.</p>
</div>
<div class="section" id="can-shard-key-be-in-ascending-order-like-dates-or-timestamps">
<h2>Can shard key be in ascending order, like dates or timestamps?<a class="headerlink" href="#can-shard-key-be-in-ascending-order-like-dates-or-timestamps" title="Permalink to this headline">¶</a></h2>
<p>If you insert documents with monotonically increasing shard keys, all
inserts will initially belong to the same <a class="reference internal" href="../../reference/glossary/#term-chunk"><em class="xref std std-term">chunk</em></a> on a single
<a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a>. Although the system will eventually divide this chunk
and migrate its contents to distribute data more evenly, at any moment
the cluster can only direct insert operations at a single shard. This
can limit the throughput of inserts.</p>
<p>If most of your write operations are updates or read operations
rather than inserts, this limitation should not impact your
performance. However, if you have a high insert volume, a
monotonically increasing shard key may be a limitation.</p>
<p>To address this issue, you can use a field with a value that stores
the hash of a key with an ascending value. While you can compute a
hashed value in your application and include this value in your
documents for use as a shard key, the <a class="reference external" href="https://jira.mongodb.org/browse/SERVER-2001">SERVER-2001</a> issue will
implement this capability within MongoDB.</p>
</div>
<div class="section" id="what-do-movechunk-commit-failed-errors-mean">
<h2>What do <tt class="docutils literal"><span class="pre">moveChunk</span> <span class="pre">commit</span> <span class="pre">failed</span></tt> errors mean?<a class="headerlink" href="#what-do-movechunk-commit-failed-errors-mean" title="Permalink to this headline">¶</a></h2>
<p>Consider the following error message:</p>
<div class="highlight-none"><div class="highlight"><pre>ERROR: moveChunk commit failed: version is at &lt;n&gt;|&lt;nn&gt; instead of &lt;N&gt;|&lt;NN&gt;&quot; and &quot;ERROR: TERMINATING&quot;
</pre></div>
</div>
<p><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt> issues this message if, during a <a class="reference internal" href="../../core/sharding-internals/#sharding-chunk-migration"><em>chunk
migration</em></a>, the <a class="reference internal" href="../../reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a> could not
connect to the <a class="reference internal" href="../../reference/glossary/#term-config-database"><em class="xref std std-term">config database</em></a> to update chunk information at
the end of the migration process. If
the shard cannot update the config database after
<a class="reference internal" href="../../reference/commands/#moveChunk" title="moveChunk"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">moveChunk</span></tt></a>, the cluster will have an inconsistent
view of all chunks. In these situations, the <a class="reference internal" href="../../reference/glossary/#term-primary"><em class="xref std std-term">primary</em></a> member of
the shard will terminate
itself to prevent data inconsistency. If the <a class="reference internal" href="../../reference/glossary/#term-secondary"><em class="xref std std-term">secondary</em></a> member
can access the config database, the shard&#8217;s data will be
accessible after an election. Administrators will need to resolve the
chunk migration failure independently.</p>
<p>If you encounter this issue, contact the <a class="reference external" href="http://groups.google.com/group/mongodb-user">MongoDB User Group</a> or 10gen support to
address this issue.</p>
</div>
</div>


<div id="btnv">
<ul id="btnvl">
<li id="btnvpr"><a href="../concurrency/" title="Previous Section: FAQ: Concurrency">&lt; &nbsp; FAQ: Concurrency</a></li>
<li id="btnvup"><a href="../" title="Parent Section: Frequently Asked Questions" >&#47;&#92;&nbsp; Frequently Asked Questions</a></li>
<li id="btnvnx"><a href="../replica-sets/" title="Next Section: FAQ: Replica Sets and Replication in MongoDB">FAQ: Replica Sets and Replication in MongoDB &nbsp;&gt;</a></li>
</ul>
</div>
</div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

<h3><a href="../../contents/">MongoDB Manual</a>
<small>(<a href="../../genindex/">Index</a>)</small>
</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about/">About MongoDB Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/">Installing MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../replication/">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sharding/">Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crud/">CRUD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aggregation/">Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indexes/">Indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications/">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mongo/">Using the MongoDB Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-cases/">Use Cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Frequently Asked Questions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../fundamentals/">FAQ: MongoDB Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/">FAQ: MongoDB for Application Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concurrency/">FAQ: Concurrency</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">FAQ: Sharding with MongoDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#is-sharding-appropriate-for-a-new-deployment">Is sharding appropriate for a new deployment?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-sharding-work-with-replication">How does sharding work with replication?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#can-i-change-the-shard-key-after-sharding-a-collection">Can I change the shard key after sharding a collection?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-happens-to-unsharded-collections-in-sharded-databases">What happens to unsharded collections in sharded databases?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-mongodb-distribute-data-across-shards">How does MongoDB distribute data across shards?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-happens-if-a-client-updates-a-document-in-a-chunk-during-a-migration">What happens if a client updates a document in a chunk during a migration?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-happens-to-queries-if-a-shard-is-inaccessible-or-slow">What happens to queries if a shard is inaccessible or slow?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-mongodb-distribute-queries-among-shards">How does MongoDB distribute queries among shards?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-mongodb-sort-queries-in-sharded-environments">How does MongoDB sort queries in sharded environments?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-mongodb-ensure-unique-id-field-values-when-using-a-shard-key-other-than-id">How does MongoDB ensure unique <tt class="docutils literal"><span class="pre">_id</span></tt> field values when using a shard key <em>other</em> than <tt class="docutils literal"><span class="pre">_id</span></tt>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#i-ve-enabled-sharding-and-added-a-second-shard-but-all-the-data-is-still-on-one-server-why">I&#8217;ve enabled sharding and added a second shard, but all the data is still on one server. Why?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#is-it-safe-to-remove-old-files-in-the-movechunk-directory">Is it safe to remove old files in the <tt class="docutils literal"><span class="pre">moveChunk</span></tt> directory?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-many-connections-does-each-mongos-need">How many connections does each <tt class="docutils literal"><span class="pre">mongos</span></tt> need?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#why-does-mongos-hold-connections">Why does <tt class="docutils literal"><span class="pre">mongos</span></tt> hold connections?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#where-does-mongodb-report-on-connections-used-by-mongos">Where does MongoDB report on connections used by <tt class="docutils literal"><span class="pre">mongos</span></tt>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-does-writebacklisten-in-the-log-mean">What does <tt class="docutils literal"><span class="pre">writebacklisten</span></tt> in the log mean?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-should-administrators-deal-with-failed-migrations">How should administrators deal with failed migrations?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-is-the-process-for-moving-renaming-or-changing-the-number-of-config-servers">What is the process for moving, renaming, or changing the number of config servers?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#when-do-the-mongos-servers-detect-config-server-changes">When do the <tt class="docutils literal"><span class="pre">mongos</span></tt> servers detect config server changes?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#is-it-possible-to-quickly-update-mongos-servers-after-updating-a-replica-set-configuration">Is it possible to quickly update <tt class="docutils literal"><span class="pre">mongos</span></tt> servers after updating a replica set configuration?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-does-the-maxconns-setting-on-mongos-do">What does the <tt class="docutils literal"><span class="pre">maxConns</span></tt> setting on <tt class="docutils literal"><span class="pre">mongos</span></tt> do?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-do-indexes-impact-queries-in-sharded-systems">How do indexes impact queries in sharded systems?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#can-shard-keys-be-randomly-generated">Can shard keys be randomly generated?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#can-shard-keys-have-a-non-uniform-distribution-of-values">Can shard keys have a non-uniform distribution of values?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#can-you-shard-on-the-id-field">Can you shard on the <tt class="docutils literal"><span class="pre">_id</span></tt> field?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#can-shard-key-be-in-ascending-order-like-dates-or-timestamps">Can shard key be in ascending order, like dates or timestamps?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-do-movechunk-commit-failed-errors-mean">What do <tt class="docutils literal"><span class="pre">moveChunk</span> <span class="pre">commit</span> <span class="pre">failed</span></tt> errors mean?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../replica-sets/">FAQ: Replica Sets and Replication in MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/">FAQ: MongoDB Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../indexes/">FAQ: Indexes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/">Reference</a></li>
</ul>

<h3>Formats</h3>
<ul class="this-page-menu">
  <li><a href="/master/single/">MongoDB Manual, Single HTML Page</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.pdf" rel="nofollow">MongoDB Manual, PDF Format</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.epub" rel="nofollow">MongoDB Manual, ePub Format</a></li>
</ul>

<h3>Translations</h3>
<ul class="translation-menu">
  <li><a href="http://jp.docs.mongodb.org/master/faq/sharding" rel="nofollow">Japanese</a></li>
  <li><a href="http://cn.docs.mongodb.org/master/faq/sharding" rel="nofollow">Chinese</a></li>
  <!-- <li><a href="http://docs.mongodb.org/master/faq/sharding" rel="nofollow">English</a></li> -->
</ul>
<h3>Knowledge Base </h3>
<ul class="kb-menu">
  <li><a href="../../tutorial/">Tutorials</a></li>
  <li><a href="../">Frequently Asked Questions</a></li>
  <li><a href="../../use-cases/">Use Cases</a></li>
</ul><h3>MongoDB Wiki</h3>

<ul>
 <li><strong>Getting Started</strong>
   <ul>
     <!-- <li><a href="http://mongodb.org/display/DOCS/Quickstart">Quickstart</a></li> -->
     <li><a href="http://mongodb.org/display/DOCS/Introduction">Introduction</a></li>
     <li><a href="http://www.mongodb.org/downloads">Downloads</a></li>
     <!-- <li><a href="http://mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart">SQL to MongoDB Mapping</a></li> -->
   </ul>
 </li>
 <li><strong><a href="http://mongodb.org/display/DOCS/Developer+Zone">Developer Documentation</a></strong>
   <!-- <ul> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Connections">Connections</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Databases">Databases</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Collections">Collections</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Documents">Documents</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/GridFS">GridFS</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Indexes">Indexes</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Querying">Querying</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Aggregation">Aggregation</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Optimization">Optimization</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Inserting">Inserting</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Updating">Updating</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Removing">Removing</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/MapReduce">MapReduce</a></li> -->
   <!-- </ul> -->
 </li>
 <li><strong><a href="http://mongodb.org/display/DOCS/Admin+Zone">Administrative Documentation</a></strong>
   <ul>
     <!-- <li><a href="http://mongodb.org/display/DOCS/Components">Components</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Journaling">Journaling</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Production+Notes">Production Notes</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Replication">Replication</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Sharding">Sharding</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Monitoring+and+Diagnostics">Monitoring and Diagnostics</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Backups">Backups</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Durability+and+Repair">Durability and Repair</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Security+and+Authentication">Security and Authentication</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/Starting+and+Stopping+Mongo">Starting/Stopping MongoDB</a></li> -->
     <!-- <li><a href="http://mongodb.org/display/DOCS/GridFS+Tools">GridFS Tools</a></li> -->
     <li><a href="http://mongodb.org/display/DOCS/DBA+Operations+from+the+Shell">DB Operations from the Shell</a></li>
     <!-- <li><a href="http://mongodb.org/display/DOCS/Architecture+and+Components">Architecture and Components</a></li> -->
     <li><a href="http://mongodb.org/display/DOCS/Windows">Windows</a></li>
     <li><a href="http://mongodb.org/display/DOCS/Troubleshooting">Troubleshooting</a></li>
   </ul>
 </li>
 <li><strong><a href="http://www.mongodb.org/display/DOCS/Community">Community and Ecosystem</a></strong>
   <ul>
     <li><a href="http://10gen.com">10gen</a></li>
     <li><a href="http://www.mongodb.org/events">MongoDB Events</a></li>
     <li><a href="http://planet.mongodb.org">Planet MongoDB</a></li>
     <li><a href="http://mongodb.org/display/DOCS/MongoDB+Masters">MongoDB Masters</a></li>
     <li><a href="http://mongodb.org/display/DOCS/Slides+and+Video">Slides and Video</a></li>
     <!-- <li><a href="http://cookbook.mongodb.org/">Cookbook</a></li> -->
     <li><a href="http://mongodb.org/display/DOCS/Hosting+Center">Hosting Center</a></li>
     <li><a href="http://mms.10gen.com/">MongoDB Monitoring Service</a> (<a href="http://mms.10gen.com/help/">docs</a>)</li>
     <li><a href="http://mongodb.org/display/DOCS/Admin+UIs">Administrative Interfaces</a></li>
     <!-- <li><a href="http://mongodb.org/display/DOCS/International+Docs">International Documentation</a></li> -->
     <li><a href="http://10gen.com/books/">MongoDB Books</a></li>
   </ul>
 </li>
 <li><strong><a href="http://www.mongodb.org/display/DOCS/Drivers">Drivers</a></strong>
   <ul>
     <li>JavaScript (<a href="http://mongodb.org/display/DOCS/Javascript+Language+Center">wiki</a>, <a href="http://api.mongodb.org/js/current">docs</a>)</li>
     <li>Python (<a href="http://mongodb.org/display/DOCS/Python+Language+Center">wiki</a>, <a href="http://api.mongodb.org/python/current">docs</a>)</li>
     <li>Ruby (<a href="http://mongodb.org/display/DOCS/Ruby+Language+Center">wiki</a>, <a href="http://api.mongodb.org/ruby/current">docs</a>)</li>
     <li>PHP (<a href="http://mongodb.org/display/DOCS/PHP+Language+Center">wiki</a>, <a href="http://php.net/mongo/">docs</a>)</li>
     <li>Perl (<a href="http://mongodb.org/display/DOCS/Perl+Language+Center">wiki</a>, <a href="http://api.mongodb.org/perl/current/">docs</a>)</li>
     <li>Java (<a href="http://mongodb.org/display/DOCS/Java+Language+Center">wiki</a>, <a href="http://api.mongodb.org/java/current">docs</a>)</li>
     <li>Scala (<a href="http://mongodb.org/display/DOCS/Scala+Language+Center">wiki</a>, <a href="http://api.mongodb.org/scala/casbah/current/">docs</a>)</li>
     <li>C# (<a href="http://mongodb.org/display/DOCS/CSharp+Language+Center">wiki</a>, <a href="http://api.mongodb.org/csharp/current/">docs</a>)</li>
     <li>C (<a href="http://mongodb.org/display/DOCS/C+Language+Center">wiki</a>, <a href="http://api.mongodb.org/c/current/">docs</a>)</li>
     <li>C++ (<a href="http://mongodb.org/pages/viewpage.action?pageId=133409">wiki</a>, <a href="http://api.mongodb.org/cplusplus/current/">docs</a>)</li>
     <li>Haskell (<a href="http://mongodb.org/display/DOCS/Haskell+Language+Center">wiki</a>, <a href="http://api.mongodb.org/haskell">docs</a>)</li>
     <li>Erlang (<a href="http://mongodb.org/display/DOCS/Erlang+Language+Center">wiki</a>, <a href="http://api.mongodb.org/erlang">docs</a>)</li>
   </ul>
 </li>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
        &copy; Copyright 2011-2012, 10gen, Inc.  Licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons</a>.

    <p>MongoDB&reg;, Mongo&reg;, and the leaf logo are registered trademarks of 10gen, Inc.</p>
    <p>The MongoDB Documentation Project uses <a href="https://github.com/mongodb/docs">GitHub</a>. Fork the repository and submit pull requests to contribute.</p>
    <p>If you find any issues with the documentation feel free to open a <a href="http://jira.mongodb.org/browse/DOCS">Jira Case</a> and we'll work to resolve it promptly.</p>

  </div><script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_require', 'inpage_linkid', pluginUrl]);
_gaq.push(['_setAccount', 'UA-7301842-8']);
_gaq.push(['_setDomainName', 'docs.mongodb.org']);
_gaq.push(['_trackPageview']);
(function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
        })();
</script>

<script type="text/javascript">
document.write(unescape("%3Cscript src='" + document.location.protocol + "//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>try { mktoMunchkin("017-HGS-593"); } catch(e) {}</script>
  </body>
</html>